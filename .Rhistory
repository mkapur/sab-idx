legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR > 2009 & YEAR < 2018 ^  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3", title = 'IPHC FISS Sablefish Bycatch') +
facet_wrap(~YEAR)
for(yrpair in c(c(1995,2005),c(2006,2017)){
for(yrpair in c(c(1995,2005),c(2006,2017))){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] ^  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yprair)) +
facet_wrap(~YEAR)
}
c(c(1995,2005),c(2006,2017))
for(yrpair in c(c(1995,2005),c(2006,2017))){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] ^  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yrpair)) +
facet_wrap(~YEAR)
}
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] ^  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yrpair)) +
facet_wrap(~YEAR)
for(yrpair in c(c(1995,2005),c(2006,2017))){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yrpair)) +
facet_wrap(~YEAR)
}
dev.off()
yrpair
for(yrpair in c(cbind(1995,2005),cbind(2006,2017))){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yrpair)) +
facet_wrap(~YEAR)
}
for(yrpair in c(list(1995,2005),list(2006,2017))){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= yrpair[1] & YEAR <= yrpair[2] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',yrpair)) +
facet_wrap(~YEAR)
}
yrpair
ymins = c(1995,2006)
ymaxs = c(2005,2017)
for(y in 1:2){
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
}
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
y
y = 1
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
y = 2
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish N^3",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
iph$sabnum <- as.numeric(iph$Sablefish_n3)/iph$skates_set ## proportion of mean
y
as.numeric(iph$skates_set)
head(iph$skates_set)
head(as.numeric(iph$skates_set))
head(as.numeric(as.character(iph$skates_set)))
iph$skates_set2 <- as.numeric(as.character(iph$skates_set))
iph$sabnum <- as.numeric(iph$Sablefish_n3)/iph$skates_set2 ## proportion of mean
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] &  !is.na(sabnum) & sabnum > 0 & sabnum < 50),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish NPUE",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
iph$sabnum
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y]),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish NPUE",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] & sabnum < 10),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish NPUE",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
ggplot() +
geom_polygon(data = usa, aes(x = long, y = lat, group = group)) +
coord_quickmap() +
scale_x_continuous(expand = c(0,0), limits = c(-180,-110), breaks = seq(-180,-120,20), labels = paste(seq(-180,-120,20), "°W")) +
scale_y_continuous(expand = c(0,0), limits = c(30,75), breaks = seq(30,75,10), labels =  paste(seq(30,75,10), "°N"))  +
theme_minimal() +
theme(panel.grid.major = element_blank(),
axis.title =element_blank(),
legend.position = 'right',
legend.key.size = unit(0.75, "cm"),
legend.text = element_text(size = 12)) +
geom_point(data = subset(iph, YEAR >= ymins[y] & YEAR <= ymaxs[y] & sabnum >0 & sabnum < 10),
aes(x = long2, y = lat2, fill = sabnum),
shape = 21,
alpha = 0.5,
stroke = 0) +
scale_fill_viridis_c()+
labs(fill = "Nonzero Sablefish NPUE",
title = paste0('IPHC FISS Sablefish Bycatch ',ymins[y],"-",ymaxs[y])) +
facet_wrap(~YEAR)
setwd("C:/Users/mkapur/Dropbox/UW/sab-idx")
save(iph, file = "./data/iph_2019-05-13.Rdata")
iph <- read.csv("./data/manual_compile_2019-05-13.csv", na.strings = "#N/A")
save(iph, file = "./data/iph_2019-05-13.Rdata")
head(iph)
iph0 <- read.csv("./data/manual_compile_2019-05-13.csv", na.strings = "#N/A")
rm(iph0)
## Load and sort raw data
require(dplyr); require(reshape2)
names(iph0)
iph0 <- read.csv("./data/manual_compile_2019-05-13.csv", na.strings = "#N/A")
names(iph0)
?VAST::make_data
require(VAST)
names(iph0)
head(iph0)
with(iph0,make_data(b_i = Sablefish_n3,
a_i = 2,
c_iz = )
# load("./data/iph_2019-05-13.Rdata")
# Your observation data (often called Data_Geostat in Thorson’s examples) is a
## data frame that needs observations (e.g. CPUE), year, vessel
# (if you want a catchability covariate),
## area swept (e.g. 0.01, input from data),
## Latitude, Longitude, Stratum name, Survey name,
## and others (bottom depth if modelling 3D, time of day,
## other descriptors specific to your study)
Data_Geostat <- iph0 %>% select(YEAR, vessel = 'IPHC', AreaSwept_km2 = 0.01,
Latitude, Longitude, Stratum = Region, Survey = 'IPHC')
)
with(iph0,make_data(b_i = Sablefish_n3,
a_i = 2,
c_iz = )
# load("./data/iph_2019-05-13.Rdata")
# Your observation data (often called Data_Geostat in Thorson’s examples) is a
## data frame that needs observations (e.g. CPUE), year, vessel
# (if you want a catchability covariate),
## area swept (e.g. 0.01, input from data),
## Latitude, Longitude, Stratum name, Survey name,
## and others (bottom depth if modelling 3D, time of day,
## other descriptors specific to your study)
Data_Geostat <- iph0 %>% select(YEAR, vessel = 'IPHC', AreaSwept_km2 = 0.01,
Latitude, Longitude, Stratum = Region, Survey = 'IPHC')
)
Data_Geostat <- iph0 %>%
select(YEAR, vessel = 'IPHC', AreaSwept_km2 = 0.01, Latitude, Longitude, Stratum = Region, Survey = 'IPHC')
Data_Geostat <- iph0 %>%
select(YEAR, AreaSwept_km2 = 0.01, Latitude, Longitude, Stratum = Region) %>%
mutate(Survey = 'IPHC')
Data_Geostat <- iph0 %>%
select(YEAR,  Latitude, Longitude, Stratum = Region) %>%
mutate(Survey = 'IPHC',AreaSwept_km2 = 0.01)
head(Data_Geostat)
names(iph0)
Data_Geostat <- iph0 %>%
select(YEAR,  Latitude, Longitude, Stratum = Region, Catch_KG = Sablefish_n3 ) %>%
mutate(Survey = 'IPHC',AreaSwept_km2 = 0.01)
head(Data_Geostat)
Data_Geostat <- iph0 %>%
select(YEAR,  Latitude, Longitude, Stratum = Region, Catch_No = Sablefish_n3 ) %>%
mutate(Survey = 'IPHC',AreaSwept_km2 = 0.01)
############################################################################################################################################################
library(TMB)
library(VAST)
library(TMBhelper)
library(ThorsonUtilities)
############################################################################################################################################################
### Define Model structure
##########################
rm(list=ls())
# setwd("C:/Users/McGowanD/Desktop/R examples/VAST inputs demo/")
# HomeDir <- getwd()
### Input my data - *** DEMO: capelin data from AFSC Gulf of Alaska bottom trawl survey for 2001-2017 (odd years only), with in situ bottom temperatures ***
Data_Set <-  read.csv("./data/manual_compile_2019-05-13.csv", na.strings = "#N/A")
Data_descrip = "IPHC_Survey_NPUE" #data description
### Define VAST version
#Version = get_latest_version(package = 'VAST') #demo is based on "VAST_v7_0_0"
Version = "VAST_v7_0_0"
##### *** A. Spatial settings: define the spatial resolution for the model, and whether to use a grid or mesh approximation ***
Method = c("Grid", "Mesh", "Spherical_mesh")[2]                        #mesh is default recommendation, number of knots need to be specified
grid_size_km = 25                                                      #Value only matters if Method="Grid"
n_x = 100                                                              #Number of "knots" used when Method="Mesh"
Kmeans_Config = list( "randomseed"=1, "nstart"=100, "iter.max"=1e3 )   #do not modify Kmeans set up
##### *** B. Model settings for each component of the model: ***
# FieldConfig: define if there is spatial (Omega) and spatio-temporal (Epsilon) variation
FieldConfig = c("Omega1"=1, "Epsilon1"=1, "Omega2"=1, "Epsilon2"=1)    #on, single factor
# RhoConfig: determine if there is autocorrelation across time for intecepts (Beta) and spatio-temporal variation (Epsilon)
RhoConfig = c("Beta1"=0, "Beta2"=0, "Epsilon1"=0, "Epsilon2"=0)        #off
# OverdispersionConfig: define if there overdispersion due to vessel effects
OverdispersionConfig = c("Delta1"=0, "Delta2"=0)                       #off
# bias.correct: implement epsilon bias correction estimator for nonlinear transformation of random effects
bias.correct = FALSE
# ObsModel: define distribution for errors and which model to run
ObsModel = c(2,0) #Conventional delta-model using clog-log link for encounter prob. & gamma distribution w/ log link for positive catches
##### *** C. Specified outputs calculated after model runs - what reports to create? ***
Options =  c("SD_site_density"=0, "SD_site_logdensity"=0, "Calculate_Range"=1, "Calculate_evenness"=0,
"Calculate_effective_area"=1, "Calculate_Cov_SE"=1, 'Calculate_Synchrony'=0, 'Calculate_Coherence'=0)
## Save files setting
# setwd(HomeDir)  #Make sure that the working directory is back where it started
# Create folder to store records
(DateFile <- paste0(getwd(),'/VAST_output_',Data_descrip,'_Dist=',ObsModel[1],'_Link=',ObsModel[2],'_',Version,'/')) #
head(Data_Set)
############################################################################################################################################################
### Preparing data for VAST
###########################
Data_Geostat = data.frame(Catch_KG = Data_Set$Sablefish_n3,
AreaSwept_km2 = rep(1,nrow(Data_Set)), #set to 1 since CPUEs already standardized
Year = Data_Set$YEAR,
Year_Num = as.factor(Data_Set$YEAR),
Lat = Data_Set$Latitude,
Lon = Data_Set$Longitude,
Station = Data_Set$Station,
Vessel = "IPHC",
fRegion = Data_Set$REG_AREA,     #Categorical factor for GOA subregions
BtmDepth = Data_Set$Depth..F.,  #Continuous covariate
fBtmDepth = Data_Set$fBtmDepth, #Categorical factor for bottom depth
BtmTemp = NA     #Continuous covariate
)
############################################################################################################################################################
### Preparing data for VAST
###########################
Data_Geostat = data.frame(Catch_KG = Data_Set$Sablefish_n3,
AreaSwept_km2 = rep(1,nrow(Data_Set)), #set to 1 since CPUEs already standardized
Year = Data_Set$YEAR,
Year_Num = as.factor(Data_Set$YEAR),
Lat = Data_Set$Latitude,
Lon = Data_Set$Longitude,
Station = Data_Set$Station,
Vessel = rep("IPHC", nrow(Data_Set)),
fRegion = Data_Set$REG_AREA,     #Categorical factor for GOA subregions
BtmDepth = Data_Set$Depth..F.,  #Continuous covariate
fBtmDepth = Data_Set$fBtmDepth, #Categorical factor for bottom depth
BtmTemp = NA     #Continuous covariate
)
############################################################################################################################################################
### Preparing data for VAST
###########################
Data_Geostat = data.frame(Catch_KG = Data_Set$Sablefish_n3,
AreaSwept_km2 = rep(1,nrow(Data_Set)), #set to 1 since CPUEs already standardized
Year = Data_Set$YEAR,
Year_Num = as.factor(Data_Set$YEAR),
Lat = Data_Set$Latitude,
Lon = Data_Set$Longitude,
Station = Data_Set$Station,
Vessel = rep("IPHC", nrow(Data_Set)),
fRegion = Data_Set$REG_AREA,     #Categorical factor for GOA subregions
BtmDepth = Data_Set$Depth..F.,  #Continuous covariate
fBtmDepth = Data_Set$fBtmDepth, #Categorical factor for bottom depth
BtmTemp = rep(NA, nrow(Data_Set))     #Continuous covariate
)
############################################################################################################################################################
### Preparing data for VAST
###########################
Data_Geostat = data.frame(Catch_KG = Data_Set$Sablefish_n3,
AreaSwept_km2 = rep(1,nrow(Data_Set)), #set to 1 since CPUEs already standardized
Year = Data_Set$YEAR,
Year_Num = as.factor(Data_Set$YEAR),
Lat = Data_Set$Latitude,
Lon = Data_Set$Longitude,
Station = Data_Set$Station,
Vessel = rep("IPHC", nrow(Data_Set)),
fRegion = Data_Set$REG_AREA,     #Categorical factor for GOA subregions
BtmDepth = Data_Set$Depth..F.,  #Continuous covariate
fBtmDepth = Data_Set$Depth..F. #Categorical factor for bottom depth
BtmTemp = rep(NA, nrow(Data_Set))     #Continuous covariate
)
############################################################################################################################################################
### Preparing data for VAST
###########################
Data_Geostat = data.frame(Catch_KG = Data_Set$Sablefish_n3,
AreaSwept_km2 = rep(1,nrow(Data_Set)), #set to 1 since CPUEs already standardized
Year = Data_Set$YEAR,
Year_Num = as.factor(Data_Set$YEAR),
Lat = Data_Set$Latitude,
Lon = Data_Set$Longitude,
Station = Data_Set$Station,
Vessel = rep("IPHC", nrow(Data_Set)),
fRegion = Data_Set$REG_AREA,     #Categorical factor for GOA subregions
BtmDepth = Data_Set$Depth..F.,  #Continuous covariate
fBtmDepth = Data_Set$Depth..F., #Categorical factor for bottom depth
BtmTemp = rep(NA, nrow(Data_Set))     #Continuous covariate
)
levels(Data_Geostat$Year_Num) <- c(1:length(unique(Data_Set$YEAR)))
make_extrapolation_info(
Region = "british_columbia",
strata.limits = strata.limits,
zone = 32,
flip_around_dateline = F
)
unique(Data_Set$Region)
unique(Data_Set$REG_AREA)
