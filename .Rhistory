Estimate_metric_tons =meanCPUE, Fleet2 =
'BC') %>%
select(-meanCPUE, -YEAR)) %>%
bind_rows(., sab2019_2 %>%
mutate(Fleet2 = 'WC', Index = Fleet, Value = Estimate_metric_tons, Type = 'Abundance',
Source = 'assessment') %>%
select(Year, Estimate_metric_tons,  Index, Type, Source, Fleet2))
DataFile  <- paste0( "C:/Users/",comp.name ,"/Dropbox/UW/sab-idx/data/" ) #paste0( RootFile,"Data/")
assc <- read.csv("./data/assessment_CPUE.csv") %>%
mutate(Source = 'assessment', Estimate_metric_tons = Value ,
Fleet2 = substr(Index,1,2)) %>%
filter(Type == 'Abundance' |Type == 'Biomass')  %>%
filter(!grepl('PUE', Index),!grepl('NUM', Index)) %>%
bind_rows(.,
read.csv(paste0(DataFile,"/BC/BC_sable_survey_data.Aug262019.csv"))  %>%
filter(START_LONGITUDE <= 0 & !is.na(CPUE_TRAPS) & !is.na(TOTAL_SABLE_WEIGHT) &
SABLE_SET_TYPE == 'StRS'  ) %>% group_by(SET_YEAR) %>%
dplyr::summarise(meanCPUE = mean(cpue)) %>%
mutate(Year = SET_YEAR, Value = meanCPUE, CV = NA,
Index = 'Filter_StRS', Type = 'Biomass', Source = 'Assessment',
Estimate_metric_tons =meanCPUE, Fleet2 =
'BC') %>%
select(-meanCPUE, -SET_YEAR)) %>%
bind_rows(.,
read.csv(paste0(DataFile,"/BC/BC_sable_survey_data.Aug262019.csv"))  %>%
filter(START_LONGITUDE <= 0 & !is.na(CPUE_TRAPS) & !is.na(TOTAL_SABLE_WEIGHT) &
SABLE_SET_TYPE == 'OFFSHORE STANDARDIZED'  ) %>% group_by(SET_YEAR) %>%
dplyr::summarise(meanCPUE = mean(cpue)) %>%
mutate(Year = SET_YEAR, Value = meanCPUE, CV = NA,
Index = 'BC_OFFSHORE_STD', Type = 'Biomass', Source = 'Assessment',
Estimate_metric_tons =meanCPUE, Fleet2 =
'BC') %>%
select(-meanCPUE, -SET_YEAR)) %>%
bind_rows(.,
read.csv(paste0(DataFile,"/BC/BC_trawl_survey_sable_data.Oct312019.csv"))  %>%
filter(LONGITUDE <= 0 & !is.na(CATCH_WEIGHT)) %>%
group_by(YEAR) %>%
dplyr::summarise(meanCPUE = mean(CATCH_WEIGHT)) %>%
mutate(Year = YEAR, Value = meanCPUE, CV = NA,
Index = 'Filter_BCTrawl', Type = 'Biomass', Source = 'Assessment',
Estimate_metric_tons =meanCPUE, Fleet2 =
'BC') %>%
select(-meanCPUE, -YEAR)) %>%
bind_rows(., sab2019_2 %>%
mutate(Fleet2 = 'WC', Index = Fleet, Value = Estimate_metric_tons, Type = 'Abundance',
Source = 'assessment') %>%
select(Year, Estimate_metric_tons,  Index, Type, Source, Fleet2))
## Correct scales
assc$Estimate_metric_tons[assc$Fleet2 == 'AK'] <- assc$Value[assc$Fleet2 == 'AK']*  1000
# assc$Estimate_metric_tons[assc$Fleet2 == 'WC'] <- assc$Value * 1000
assc$Estimate_metric_tons[assc$Fleet2 == 'BC'] <- assc$Value[assc$Fleet2 == 'BC'] * 1000
names(assc) <- c('Year','Value','SD_log',"Fleet","TYPE", 'Source',"Estimate_metric_tons","Fleet2")
assc <- assc %>%
select(Year, Fleet, Estimate_metric_tons, SD_log, TYPE, Source, Fleet2 ) %>%
mutate(uci=NA, lci = NA)
## see line 81 here for conv https://github.com/James-Thorson-NOAA/FishStatsUtils/blob/master/R/plot_index.R
vastc <- read.csv(paste0(DateFile,"Table_for_SS3.csv")) %>%
mutate(TYPE = 'Abundance', Source = 'VAST',
lci = Estimate_metric_tons-SD_mt,
uci = Estimate_metric_tons+SD_mt) %>%
select(Year, Fleet, Estimate_metric_tons, SD_log, TYPE, Source, uci, lci ) #%>%
## see line 81 here for conv https://github.com/James-Thorson-NOAA/FishStatsUtils/blob/master/R/plot_index.R
# vastc <-
vastc <- read.csv("C:/Users/mkapur/Dropbox/UW/sab-idx/runs/2020-01-23_nx=500_Triennial_WCGBTS_BCs_BCo_AK_DOM_LL_GOA_baseQ=AK_DOM_LL1980_2018/Table_for_SS3.csv") %>%
# read.csv(paste0(DateFile,"Table_for_SS3.csv")) %>%
mutate(TYPE = 'Abundance', Source = 'VAST',
lci = Estimate_metric_tons-SD_mt,
uci = Estimate_metric_tons+SD_mt) %>%
select(Year, Fleet, Estimate_metric_tons, SD_log, TYPE, Source, uci, lci ) #%>%
# filter(Fleet != 'Gulf_of_Alaska')
vastc$Fleet2 <- NA
for(i in 1:nrow(vastc)){
vastc$Fleet2[i] <- ifelse(vastc$Fleet[i] == "California_current",
"WC",
ifelse(vastc$Fleet[i] == "British_Columbia", "BC",
"AK"))
if(vastc$Fleet[i] == 'AllAreas')   vastc$Fleet2[i] <- "ALL"
}
fleetSel <- c(1:4,6,7,10,8,11,12)
custnames <- c(paste0('VAST ',c('California Current','British Columbia',
'Aleutian Islands', 'Gulf of Alaska','Eastern Bering Sea') ),
'AK Domestic Longline', "AK Gulf Trawl", 'BC Offshore Standardized','BC Synoptic Trawl','BC Trap Stratified',
'Triennial','WCGBTS')[fleetSel]
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y =Estimate_metric_tons, col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',show.legend = FALSE) +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
cbbPalette <- c("#000000", "#009E73", "#e79f00", "#9ad0f3", "#0072B2", "#D55E00",
"#CC79A7", "navy", "#F0E442" )
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y =Estimate_metric_tons, col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',show.legend = FALSE) +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',show.legend = FALSE) +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',show.legend = c(T,F)) +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',show.legend = TRUE) +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = TRUE) +
# scale_y_continuous(limits = c(0,2e6))+
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + WC have been multiplied by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = FALSE) +
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '')+ #,
# subtitle = 'BC + AK ASSC have been multiplied by 1000; input dat was div by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = FALSE) +
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '',
subtitle = 'BC + AK ASSC have been
multiplied by 1000; input dat was div by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = FALSE) +
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '',
subtitle = 'Assessment vals have been multiplied by 1000; input dat was div by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = FALSE) +
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '',
subtitle = 'BC&AK Assessment vals have been multiplied by 1000; input dat was div by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
## compare_all plot ----
rbind(vastc,assc) %>%
filter(Fleet2 %in% c('WC','BC', 'AK')[1:3]) %>%
filter(Fleet %in% c("California_current","British_Columbia",
'Aleutian_Islands',"Gulf_of_Alaska",
"Eastern_Bering_Sea",
'AK_DOM_LL',"AK_GOA_TRW",'BC_OFFSHORE_STD',
"Filter_BCTrawl","Filter_StRS", "AKSHLF",  "NWCBO")[fleetSel]) %>%
filter(Year < 2019) %>%
# filter(Fleet %in% c("British_Columbia","Filter_BCTrawl")) %>%
ggplot(., aes(x = Year, y = Estimate_metric_tons,
col = Fleet, linetype = Fleet)) +
theme_bw()+
# kaputils::theme_black()+
theme(panel.grid = element_blank(),
legend.position = 'right',
legend.text = element_text(size = 12),
strip.text.x = element_text(
size = 16
)) +
geom_line(lwd = 1) +
geom_ribbon(aes(ymin = lci, ymax = uci, fill = Fleet),
alpha = 0.15, col = 'grey',
show.legend = FALSE) +
scale_x_continuous(limits = c(1980,2018),
breaks = seq(1980,2020,10)) +
scale_fill_manual(values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_color_manual( values = c(rep('blue',3), 'dodgerblue3',
cbbPalette),
labels = c(custnames)) +
scale_linetype_manual(values = c(rep('solid',4),
rep('dashed',40)),
labels = c(custnames)) +
labs(x = 'Year', y = 'Estimate (mt)', color = "", linetype = "",
title = '',
subtitle = 'BC&AK assessment vals have been multiplied by 1000; input dat was div by 1000') +
facet_wrap(~Fleet2, scales = 'free_y', ncol = 3)
ggsave(plot = last_plot(),
# file = paste0("./figures/",Sys.Date(),"_idx_comparison.png"),
file = paste0(DateFile,"/compare_all-update.png"),
height = 8, width = 12, unit='in',dpi = 320)
